# テストフレームワーク
 - テストケースをテストする

## 概要
 - ユーザーの動作（メニューから戦争選んで出発、戦闘をする）等をエミュレートするコントローラーを使ってテストケースを書き、動作が期待通りかどうかテストする
 - TestFramework/Scripts/testsディレクトリにperlスクリプトを入れておくとテストケースとして認識される。ディレクトリを階層化しても問題ない。
 - テストはtest_browser.cgiにアクセスし、スクリプトタブから選択して実行する

## test_browser.cgi
 - これに?pass=passwardを加えてブラウザからアクセスする
 - 手動タブからはコントローラーを直接操作出来る（実際は小さスクリプトを実行している）
 - スクリプトタブからはテストケースの実行や、ユーザーの全消去等のユーティリティースクリプトを実行できる
 - セーブ＆ロードタブからはゲームデータのセーブ＆ロードが行える

## テストの書き方
 - TestFramework/Scripts/tests/samplesにチュートリアル用のテストケースが入っているので参照

## 新しく追加された情勢をテストする例
 - 国をリセットして綺麗な状態にする
 - 何人かプレイヤーを作成し、国に士官させる
 - WorldControllerから$w{data}を書き換えられるので、新しい情勢の直前の年度を$w{year}に設定する
 - $w{game_lv}を1に設定し統一難易度をLv１にする
 - 国に所属するどれかのプレイヤーに戦争→勝利させ、統一させる
 - 新年度が新情勢かチェックする
 - 新情勢で最初に行われる動作をチェックする（全員ﾈﾊﾞﾗﾝ送りなら全員の所属国かﾈﾊﾞﾗﾝかどうか、混乱等なら混乱チェックが入ったプレイヤーは移動してないか、入っていないプレイヤーはﾈﾊﾞﾗﾝ送りになっていないか、投票状況や君主代表のチェック等）
 - 新情勢の進行をチェックする。（新情勢特有の動作や禁止ﾍﾟｯﾄが使えないか等）
 - 統一難易度を下げて誰かに戦争させる手法で統一処理を呼ぶ
 - 新情勢の終了後の処理をチェック（勝利国にアイテムが分配されるならチェック、祭り熟練等のチェック等）
 - テスト終了

